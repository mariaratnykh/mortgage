<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: showbanks.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: showbanks.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module show-banks */

import {banks} from './banks-data';
import {addWhiteSpaceInNumbers} from './whitespace';
export {showMaxPropertyCost, showBanks};

let screen = document.querySelector('.screen');

/**
 * Funtion creates block with information about max property cost and 
 * insert it before banks cards. 
 * @static
 */
function showMaxPropertyCost () {
  let values = getMaxPropertyCostAndBankName(banks);
  let fragment = document.createDocumentFragment();
  let totalCost = document.createElement('h3');
  if(values[0] != undefined) {
    totalCost.textContent = `Максимально возможная стоимость квартиры по вашим
    параметрам составляет ${addWhiteSpaceInNumbers(values[0])} рублей в банке "${values[1]}"`; 
  } else {
    totalCost.textContent = `К сожалению, ни один банк не готов предоставить Вам кредит. 
    Попробуйте увеличить сумму первоначального взноса`;
    screen.style.marginBottom = '300px';
  }
  fragment.appendChild(totalCost);
  fragment.appendChild(createReloadButton());
  screen.insertBefore(fragment, screen.firstChild);
}

/** Function creates button, which reloads page */
function createReloadButton () {
  let reloadButton = document.createElement('button');
  reloadButton.classList.add('button');
  reloadButton.classList.add('button-reload');
  reloadButton.textContent = 'Пересчитать снова';
  const reloadButtonHandler = () => {
    window.location.reload();
    reloadButton.removeEventListener('click', reloadButtonHandler);
  }
  reloadButton.addEventListener('click', reloadButtonHandler);
  return reloadButton;
}

/** Function search the maximum of loans from banks. Returns loan value and 
 * bank name.
 * @param {object[]} banks - the array of all banks 
 * @returns {object[]} - [loan, bank.name]
  */
function getMaxPropertyCostAndBankName(banks) {
  let loansArray = [];
  let banksNames = [];
  console.log(banks[0].isGiveTheLoan());
  banks.forEach((bank) => {
    if (bank.isGiveTheLoan()) {
      loansArray.push(+bank.creditAmountPlusDeposit());
      banksNames.push(bank.name);
    }
  });
  console.log(loansArray)
  let maxLoan = Math.max.apply(null, loansArray);
  let maxLoanIndex = loansArray.indexOf(maxLoan);
  return [loansArray[maxLoanIndex], banksNames[maxLoanIndex]];
}

/** Function fill the template of bank-card with bank information
 * @param {object} bank - the instance of Bank class
 * @returns {document-fragment}
 */
function createBankCard (bank) {
  let template = document.querySelector('.bank').content.cloneNode(true);
  template.querySelector('.bank__logo').src = bank.logo;
  template.querySelector('.bank__title').textContent = bank.name;
  template.querySelector('.bank__deposit--title').textContent = bank.depositPercent + '%';
  template.querySelector('.bank__percentage').textContent = bank.percent + '% годовых';
  template.querySelector('.bank__rating--title').textContent = bank.rating + ' место';
  template.querySelector('.bank__card--button').data = bank;
  return template;
}

/** Function shows banks, which is ready to give the loan. Creates and insert
 * bank-cards of such banks.
 * @static
 */
function showBanks () {
  screen.textContent = "";
  banks.forEach((bank) => {
    if(bank.isGiveTheLoan()) {
      screen.appendChild(createBankCard(bank))
    }
  })
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-bank-class.html">bank-class</a></li><li><a href="module-bank-data.html">bank-data</a></li><li><a href="module-chart.html">chart</a></li><li><a href="module-connect-inputs.html">connect-inputs</a></li><li><a href="module-main.html">main</a></li><li><a href="module-popup.html">popup</a></li><li><a href="module-show-banks.html">show-banks</a></li><li><a href="module-whitespace.html">whitespace</a></li></ul><h3>Classes</h3><ul><li><a href="module-bank-class.Bank.html">Bank</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Nov 01 2018 13:43:43 GMT+0300 (GMT+03:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
